<div class="filtros">
  <h2 (click)="toggleFilterOptions()">Gestion de ventas</h2>
  <div class="btn-filtros" *ngIf="filterOptionsVisible">
    <button (click)="selectFilter('crear')">Crear Venta</button>
    <button (click)="selectFilter('editar')">Editar Venta</button>
    <button (click)="selectFilter('eliminar')">Eliminar Venta</button>
    <button (click)="selectFilter('buscar')">Buscar Venta</button>
  </div>
</div>

<div *ngIf="selectedFilter === 'crear'" class="section-form">
  <h2>Crear Venta</h2>
  <form [formGroup]="createForm" (ngSubmit)="createSale()" class="form-group">
    <input formControlName="fk_user" placeholder="Usuario" type="number" required />
    <input formControlName="fk_prod" placeholder="Producto" type="number" required />
    <input formControlName="fk_estado" placeholder="Estado" type="number" required />
    <input formControlName="fecha" type="date" required />
    <input formControlName="hora" type="time" required />
    <input formControlName="cantidad" placeholder="Cantidad" type="number" required />
    <input formControlName="total" placeholder="Total" type="number" step="0.01" required />
    <input formControlName="cod_compra" placeholder="C贸digo de Compra" type="text" required />
    <button type="submit">Crear</button>
  </form>
</div>

<div *ngIf="selectedFilter === 'editar'" class="section-form">
  <h2>Editar Venta</h2>
  <form [formGroup]="editForm" (ngSubmit)="updateSale()" class="form-group">
    <input formControlName="id_venta" placeholder="ID Venta" type="number" required />
    <input formControlName="fk_user" placeholder="Usuario" type="number" />
    <input formControlName="fk_prod" placeholder="Producto" type="number" />
    <input formControlName="fk_estado" placeholder="Estado" type="number" />
    <input formControlName="fecha" type="date" />
    <input formControlName="hora" type="time" />
    <input formControlName="cantidad" placeholder="Cantidad" type="number" />
    <input formControlName="total" placeholder="Total" type="number" step="0.01" />
    <input formControlName="cod_compra" placeholder="C贸digo de Compra" type="text" />
    <button type="submit">Actualizar</button>
  </form>
</div>

<div *ngIf="selectedFilter === 'eliminar'" class="section-form">
  <h2>Eliminar Venta</h2>
  <form [formGroup]="deleteForm" (ngSubmit)="deleteSale(deleteForm.value.id_venta)" class="form-group">
    <input formControlName="id_venta" placeholder="ID de la Venta a Eliminar" type="number" required />
    <button type="submit">Eliminar</button>
  </form>
</div>

<div *ngIf="selectedFilter === 'buscar'" class="section-form">
  <h2>Buscar Venta</h2>
  <form [formGroup]="searchForm" (ngSubmit)="searchSaleById(searchForm.value.id_venta)" class="form-group">
    <input formControlName="id_venta" placeholder="ID de la Venta a Buscar" type="number" required />
    <button type="submit">Buscar</button>
  </form>

  <div *ngIf="saleFound" class="section-form">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Usuario</th>
          <th>Producto</th>
          <th>Estado</th>
          <th>Fecha</th>
          <th>Hora</th>
          <th>Cantidad</th>
          <th>Total</th>
          <th>C贸digo Compra</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>{{ search.id_venta }}</td>
          <td>{{ search.fk_user }}</td>
          <td>{{ search.fk_prod }}</td>
          <td>{{ search.fk_estado }}</td>
          <td>{{ search.fecha }}</td>
          <td>{{ search.hora }}</td>
          <td>{{ search.cantidad }}</td>
          <td>{{ search.total }}</td>
          <td>{{ search.cod_compra }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="error && !saleFound">
    <p class="mensaje-error">{{ error }}</p>
  </div>
</div>

<div class="section-form">
  <h2>Ventas</h2>
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Usuario</th>
        <th>Producto</th>
        <th>Estado</th>
        <th>Fecha</th>
        <th>Hora</th>
        <th>Cantidad</th>
        <th>Total</th>
        <th>C贸digo Compra</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let sale of sales">
        <td>{{ sale.id_venta }}</td>
        <td>{{ sale.fk_user }}</td>
        <td>{{ sale.fk_prod }}</td>
        <td>{{ sale.fk_estado }}</td>
        <td>{{ sale.fecha }}</td>
        <td>{{ sale.hora }}</td>
        <td>{{ sale.cantidad }}</td>
        <td>{{ sale.costo_total }}</td>
        <td>{{ sale.cod_compra }}</td>
      </tr>
    </tbody>
  </table>
</div>
